This is chapter2 aliance version